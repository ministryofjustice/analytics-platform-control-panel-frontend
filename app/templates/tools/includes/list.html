{% block main_column %}

<p>Please refresh your browser to update the status of your tools.</p>

<table class="form-group list">
  <thead>
    <tr>
      {% if current_user.is_superuser %}
        </s><th>Namespace</th>
      {% endif %}
      <th>Name</th>
      <th>Status</th>
      <th><span class="visuallyhidden">Actions</span></th>
    </tr>
  </thead>
  <tbody>
    {% if tools.length %}
      {% for tool in tools %}

      {%- set tool_name = tool.metadata.labels.app -%}
      {%- set tool_url = get_tool_url(tool_name, current_user.username) -%}

      <tr>
        {% if current_user.is_superuser %}
        <td>{{ tool.metadata.namespace }}</td>
        {% endif %}
        <td>{{ tool_name }}</td>
        <td>{% for pod in tool.pods %}{{ loop.index }}. {{ pod.display_status }}<br>{% endfor %}</td>
        <td class="align-right no-wrap">
          <a class="button button-secondary" target="_blank" href="{{ tool_url }}">Open</a>
          <a class="button button-secondary" href="{{ url_for('tools.restart', { name: tool.metadata.name }) }}">Restart</a>
        </td>
      </tr>
      {% endfor %}
    {% else %}
      {% if current_user.is_superuser %}
        <td>user-{{ current_user.username }}</td>
      {% endif %}
      <td>RStudio</td>
      <td>
        {% if rstudio_is_deploying %}
          Deploying
        {% else %}
          Not deployed
        {% endif %}
      </td>
      <td class="align-right no-wrap">
        {% if not rstudio_is_deploying %}
          <form action="{{ url_for('tools.deploy', { name: 'rstudio' }) }}" method="post" class="inline-form clearfix">
            <input type="submit" class="button button-secondary right" value="Deploy" />
          </form>
        {% endif %}
      </td>
    {% endif %}
    </tbody>
  </table>

{% endblock %}
